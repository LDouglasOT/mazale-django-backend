name: Deploy to Production

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Webhook with Signature
        uses: distributhor/workflow-webhook@v3
        with:
          webhook_url: "https://sugarmummiesug.online/api/deploy-webhook-secret-abc123/"
          # We use the raw string here to match your settings.py exactly
          webhook_secret: "MazalePayload"
          # This data must be exactly what is hashed on the server
          data: '{"status": "deploying"}'
          # This ensures the header is set correctly for Django
          method: POST
          content_type: application/json